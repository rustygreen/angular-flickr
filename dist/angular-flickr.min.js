"use strict";angular.module("flickr.config",[]).value("flickrConfig",{}),angular.module("flickr.services",["flickr.config","ngResource"]),angular.module("flickr.plugins",["flickr.config","flickr.services"]),angular.module("flickr.filters",["flickr.config","flickr.services"]),angular.module("flickr.directives",["flickr.config","flickr.services"]),angular.module("flickr",["flickr.config","flickr.services","flickr.plugins","flickr.filters","flickr.directives"]),angular.module("flickr.services").factory("Photo",["$resource","flickrConfig",function(a,b){var c=angular.extend({url:"https://api.flickr.com/services/rest/",params:{common:{format:"json",api_key:"8f423858224200b697154135ac10103a",jsoncallback:"JSON_CALLBACK"},get:{photoset_id:"",extras:"",privacy_filter:"",per_page:"",page:"",media:"",method:"flickr.photosets.getPhotos"},query:{user_id:"",page:"",per_page:"",method:"flickr.photosets.getList"}}},b.photoSet);return a(c.url,c.params.common,{get:{method:"JSONP",params:c.params.get,callback:c.params.jsoncallback},query:{method:"JSONP",params:c.params.query,callback:c.params.jsoncallback,isArray:!1}})}]),angular.module("flickr.services").factory("Photoset",["$resource","flickrConfig",function(a,b){var c=angular.extend({url:"https://api.flickr.com/services/rest/",params:{common:{format:"json",api_key:b.api_key||b.apiKey||"006d5ace5a1ec6e87d501a2753da1bc7",jsoncallback:"JSON_CALLBACK"},get:{photoset_id:"",extras:"",privacy_filter:"",per_page:"",page:"",media:"",method:"flickr.photosets.getPhotos"},query:{page:"",per_page:"",method:"flickr.photosets.getList"}}},b.photoset);return a(c.url,c.params.common,{get:{method:"JSONP",params:c.params.get,callback:c.params.jsoncallback},query:{method:"JSONP",params:c.params.query,callback:c.params.jsoncallback,isArray:!1}})}]),angular.module("flickr.services").factory("flickrLoading",function(){return{isLoading:!1}}),angular.module("flickr.directives").directive("eatClick",function(){return function(a,b){b.bind("click",function(a){a.preventDefault()})}}),angular.module("flickr.directives").directive("imgAnimate",["$animator",function(a){return function(b,c,d){var e=a(b,d);c.bind("load",function(a){console.log("here................"),e.animate("photoset-thumbnails",c)})}}]),angular.module("flickr.directives").directive("loadingBalls",["flickrLoading",function(a){return{scope:{search:"="},restrict:"EA",replace:!0,template:'<div class="loading-balls-container" ng-show="flickrLoading.isLoading" ng-animate="\'animate\'"><div class="loading"><span class="ball1"></span><span class="ball2"></span></div></div>',link:function(b){b.flickrLoading=a}}}]),angular.module("flickr.directives").directive("photoFilter",["Photoset",function(a){return{scope:{search:"="},restrict:"EA",replace:!0,template:'<div class="row"><div class="col-lg-12"><a href="" ng-click="visible=!visible"><i ng-class="{btn:true, glyphicon:true, \'glyphicon-chevron-down\': !visible, \'glyphicon-chevron-up\': visible}"></i> Filter Options</a><div ng-show="visible"><div class="input-group"><span class="input-group-addon glyphicon glyphicon-search"></span><input type="text" class="form-control" ng-model="search.filter" placeholder="Search"></div><div class="input-group"><span class="input-group-addon glyphicon glyphicon-sort-by-attributes"></span><select class="form-control" placeholder="Order By"><option value="item.value" ng-repeat="item in orders">{{item.text}}</option></select></div><div class="input-group"><span class="input-group-addon glyphicon glyphicon-filter"></span><select class="form-control" placeholder="Limit To"><option value="item.value" ng-repeat="item in limits">{{item.text}}</option></select></div></div></div></div>',link:function(a){a.search||(a.orders=[{text:"Date",value:"date"}],a.limits=[{text:"25",value:"25"},{text:"50",value:"50"},{text:"75",value:"75"},{text:"100",value:"100"},{text:"No Limit",value:""}],a.search={filter:"",order:"",limit:100})}}}]),angular.module("flickr.directives").directive("photosetList",["flickrConfig","flickrLoading","Photoset",function(a,b,c){var d=angular.extend({autoSelectIndex:0,user_id:a.user_id||"99179128@N07"},a.photosetList);return{scope:{sets:"=",set:"=",setId:"=",listClass:"@",itemClass:"@"},restrict:"EA",replace:!0,template:'<div><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-filter"></i></span><input class="form-control" ng-model="filterPhotosets" placeholder="filter photo sets"/></div><ul class="{{listClass}}"/><li ng-repeat="photoset in $sets.photosets.photoset | filter:filterPhotosets"  class="{{itemClass}}" ng-class="{active:set.id==selectedId}" ng-animate="\'photoset-list\'"><a ng-if="photoset.id !== set.id" href="" ng-click="setSelected(photoset)">{{photoset.title._content}}</a><span ng-if="photoset.id == set.id">{{photoset.title._content}}</span></li></ul></div>',link:function(a,e,f){b.isLoading=!0,a.$sets=c.query({user_id:d.user_id},function(c){c&&c.photosets&&c.photosets.photoset&&c.photosets.photoset.length&&d.autoSelectIndex>-1&&a.setSelected(c.photosets.photoset[0]),b.isLoading=!1}),f.sets&&(a.sets=a.$sets),a.setSelected=function(b){f.setId&&(a.setId=b.id),f.set&&(a.set=b)}}}}]),angular.module("flickr.directives").directive("photosetPanel",["flickrLoading",function(a){return{scope:{panelTitle:"@",panelClass:"@"},restrict:"EA",replace:!0,template:'<div class="panel {{panelClass}}"><div class="panel-heading"><div class="panel-title">{{panelTitle}} <loading-balls class="pull-right"></loading-balls></div></div><photoset-list list-class="breadcrumb" set="photoset"></photoset-list><div class="row"><div class="col-lg-3"><photoset-thumbnails ng-show="photoset" thumbnail-class="img-thumbnail"photo="photo" set-id="{{photoset.id}}"></photoset-thumbnails></div><div class="col-lg-9"><photoset-slideshow photo="photo" photo-class="thumbnail"></photoset-slideshow></div></div></div>',link:function(b){b.flickrLoading=a}}}]),angular.module("flickr.directives").directive("photosetSlideshow",["$rootScope","$timeout","Photoset",function(a,b,c){return{scope:{photo:"=",next:"&",previous:"&",size:"@",interval:"@",setId:"@",outerClass:"@",photoClass:"@"},restrict:"EA",replace:!0,template:'<div class="carousel slide {{outerClass}}" ng-show="$photo"><div class="carousel-inner text-center"><div class="{{photoClass}} item active"><img ng-src="{{$photo[$size]}}" src="" alt="" /></div><div ng-show="$photo.title" class="carousel-caption">{{$photo.title}}</div></div><a class="left carousel-control" href="" ng-click="$previous()"><span class="glyphicon glyphicon-chevron-left"></span></a><a class="right carousel-control" href="" ng-click="$next()"><span class="glyphicon glyphicon-chevron-right"></span></a></div>',link:function(d,e,f){var g,h;d.$size=d.size||"large";var i=function(){var a=-1;return g&&d.$photo&&angular.forEach(g.photo,function(b,c){b.id===d.$photo.id&&(a=c)}),a},j=function(a){g&&g.photo&&g.photo.length&&(a>=g.photo.length?a=0:0>a&&(a=g.photo.length-1),d.$photo=g.photo[a])};f.$observe("setId",function(a){a&&(g=c.get({photoset_id:a},function(a){a.photo&&a.photo.length&&(d.$photo=a.photo[0])}))});var k=function(){h&&b.cancel(h)},l=function(){k(),f.interval&&(h=b(function(){console.log("Setting timer",f.interval),d.$next(),l()},f.interval))};f.$observe("interval",function(a){a&&l()}),d.$next=function(){j(i()+1),d.next&&d.next(),a.$broadcast("photoset.photo.request.next")},d.$previous=function(){j(i()-1),d.previous&&d.previous(),a.$broadcast("photoset.photo.request.previous")},d.$watch("photo",function(a,b){a&&a!==b&&(d.$photo=a)})}}}]),angular.module("flickr.directives").directive("photosetThumbnails",["flickrConfig","flickrLoading","Photoset",function(a,b,c){var d=angular.extend({},a.photosetThumbnails);return{scope:{setId:"@",photos:"=",thumbnailClass:"@",useFilter:"=",multiSelect:"=",selectCallback:"="},restrict:"EA",replace:!0,template:'<div><photo-filter ng-if="useFilter" search="search" orders="" ></photo-filter><div ng-if="multiSelect"><button ng-click="selectAll()" class="btn btn-default">Select All</button><button ng-click="deselectAll()" class="btn btn-default">Deselect All</button></div><a ng-class="classNames(img)"ng-repeat="img in photoset.photo | filter:search.filter | orderBy:search.order | limitTo:search.limit" ng-animate="\'photoset-thumbnails\'"><img ng-click="thumbnailClick(img)" ng-src="{{img.small}}" src="" alt="" /></a></div>',link:function(a,e,f){var g={clicky:!0,"photoset-thumbnail":!0};a.multiSelect&&(a.photos=[]),f.thumbnailClass&&(g[f.thumbnailClass]=!0),a.classNames=function(a){return angular.extend(g,{active:a.selected})},a.thumbnailClick=function(b,c){return a.selectCallback?void a.selectCallback(b):void console.error("no callback found, we can't assign the picture")},a.selectAll=function(){angular.forEach(a.photoset.photo,function(b){a.thumbnailClick(b,!0)})},a.deselectAll=function(){angular.forEach(a.photoset.photo,function(b){a.thumbnailClick(b,!1)})},f.$observe("setId",function(e){e&&(b.isLoading=!0,c.get({photoset_id:e},function(c){angular.forEach(c.photoset.photo,function(a){var b="http://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.id+"_"+a.secret;angular.extend(a,{small:b+"_s.jpg",medium:b+"_q.jpg",large:b+"_b.jpg"})}),c&&c.photo&&c.photo.length&&d.autoSelectIndex>-1&&(a.thumbnailClick(c.photo[d.autoSelectIndex]),b.isLoading=!1),a.photoset=c.photoset}))}),f.$observe("thumbnailClass",function(a){g[f.thumbnailClass]=!0});var h=function(){var b=-1;return angular.forEach(a.photoset.photo,function(c,d){c.id===a.photo.id&&(b=d)}),b},i=function(b){b>=a.photoset.photo.length?b=0:0>b&&(b=a.photoset.photo.length-1),a.thumbnailClick(a.photoset.photo[b])},j=function(){i(h()+1)},k=function(){i(h()-1)};a.$on("photoset.photo.request.previous",k),a.$on("photoset.photo.request.next",j)}}}]);